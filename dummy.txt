import java.io.*;
import java.net.*;
import java.util.*;

class ChatServer {
    static Set<PrintWriter> clients = new HashSet<>();

    public static void main(String[] args) throws Exception {
        ServerSocket ss = new ServerSocket(5000);
        System.out.println("Server started...");
        while (true) {
            Socket s = ss.accept();
            PrintWriter out = new PrintWriter(s.getOutputStream(), true);
            clients.add(out);
            new Thread(() -> handleClient(s, out)).start();
        }
    }

    static void handleClient(Socket s, PrintWriter out) {
        try {
            BufferedReader in = new BufferedReader(new InputStreamReader(s.getInputStream()));
            String name = in.readLine();
            broadcast(name + " joined the chat");
            String msg;
            while ((msg = in.readLine()) != null) {
                if (msg.equalsIgnoreCase("/quit")) break;
                broadcast(name + ": " + msg);
            }
        } catch (Exception ignored) {}
        finally { clients.remove(out); broadcast("A user left."); }
    }

    static void broadcast(String msg) {
        for (PrintWriter c : clients) c.println(msg);
        System.out.println(msg);
    }
}
import java.io.*;
import java.net.*;

class ChatClient {
    public static void main(String[] args) throws Exception {
        Socket s = new Socket("localhost", 5000);
        BufferedReader in = new BufferedReader(new InputStreamReader(s.getInputStream()));
        PrintWriter out = new PrintWriter(s.getOutputStream(), true);
        BufferedReader kb = new BufferedReader(new InputStreamReader(System.in));

        System.out.print("Enter your name: ");
        out.println(kb.readLine());
        new Thread(() -> {
            try { String line; while ((line = in.readLine()) != null) System.out.println(line); }
            catch (Exception ignored) {}
        }).start();

        String msg;
        while ((msg = kb.readLine()) != null) {
            out.println(msg);
            if (msg.equalsIgnoreCase("/quit")) break;
        }
        s.close();
    }
}
import java.io.*;
import java.net.HttpURLConnection;
import java.net.URL;

public class FileDownloader {
    public static void main(String[] args) throws Exception {
        String downloadUrl = "http://localhost:8000/download";
        HttpURLConnection connection = (HttpURLConnection) new URL(downloadUrl).openConnection();

        connection.setRequestMethod("GET");

        try (InputStream in = connection.getInputStream();
             FileOutputStream out = new FileOutputStream("downloaded.txt")) {
            byte[] buffer = new byte[1024];
            int bytesRead;
            while ((bytesRead = in.read(buffer)) != -1) {
                out.write(buffer, 0, bytesRead);
            }
        }

        System.out.println("File downloaded successfully!");
    }
}
import com.sun.net.httpserver.*;
import java.io.*;
import java.net.*;

public class FileServer {

    private static final String UPLOAD_DIR = "uploads";

    public static void main(String[] args) throws Exception {
        File uploadDir = new File(UPLOAD_DIR);
        if (!uploadDir.exists()) {
            uploadDir.mkdir();
        }

        HttpServer server = HttpServer.create(new InetSocketAddress(8000), 0);
        System.out.println("Server started at http://localhost:8000");

        server.createContext("/upload", new UploadHandler());
        server.createContext("/download", new DownloadHandler());

        server.setExecutor(null);
        server.start();
    }

    // Handler for uploading files
    static class UploadHandler implements HttpHandler {
        @Override
        public void handle(HttpExchange exchange) throws IOException {
            if ("POST".equals(exchange.getRequestMethod())) {
                // Read file data
                InputStream input = exchange.getRequestBody();
                FileOutputStream fos = new FileOutputStream(UPLOAD_DIR + "/uploaded_file.txt");
                byte[] buffer = new byte[1024];
                int bytesRead;
                while ((bytesRead = input.read(buffer)) != -1) {
                    fos.write(buffer, bytesRead, bytesRead);
                }
                fos.close();

                String response = "File uploaded successfully!";
                exchange.sendResponseHeaders(200, response.length());
                OutputStream os = exchange.getResponseBody();
                os.write(response.getBytes());
                os.close();}
            // } else {
            //     String htmlForm = "<form method='POST' enctype='multipart/form-data' action='/upload'>" +
            //             "<input type='file' name='file'><br><input type='submit' value='Upload'>" +
            //             "</form>";
            //     exchange.sendResponseHeaders(200, htmlForm.length());
            //     OutputStream os = exchange.getResponseBody();
            //     os.write(htmlForm.getBytes());
            //     os.close();
            // }
        }
    }

    // Handler for downloading files
    static class DownloadHandler implements HttpHandler {
        @Override
        public void handle(HttpExchange exchange) throws IOException {
            File file = new File(UPLOAD_DIR + "/uploaded_file.txt");
            if (file.exists()) {
                exchange.getResponseHeaders().add("Content-Disposition", "attachment; filename=download.txt");
                exchange.sendResponseHeaders(200, file.length());

                OutputStream os = exchange.getResponseBody();
                FileInputStream fis = new FileInputStream(file);
                byte[] buffer = new byte[1024];
                int bytesRead;
                while ((bytesRead = fis.read(buffer)) != -1) {
                    os.write(buffer, 0, bytesRead);
                }
                fis.close();
                os.close();}
            // } else {
            //     String response = "No file found!";
            //     exchange.sendResponseHeaders(404, response.length());
            //     OutputStream os = exchange.getResponseBody();
            //     os.write(response.getBytes());
            //     os.close();
            // }
        }
    }
}
import java.io.*;
import java.net.HttpURLConnection;
import java.net.URL;

public class FileUploader {
    public static void main(String[] args) throws Exception {
        File file = new File("test.txt");  // file to upload
        String uploadUrl = "http://localhost:8000/upload";

        HttpURLConnection connection = (HttpURLConnection) new URL(uploadUrl).openConnection();
        connection.setDoOutput(true);
        connection.setRequestMethod("POST");
        connection.setRequestProperty("Content-Type", "application/octet-stream");

        try (OutputStream os = connection.getOutputStream();
             FileInputStream fis = new FileInputStream(file)) {
            byte[] buffer = new byte[1024];
            int bytesRead;
            while ((bytesRead = fis.read(buffer)) != -1) {
                os.write(buffer, 0, bytesRead);
            }
        }

        int responseCode = connection.getResponseCode();
        System.out.println("Upload Response: " + responseCode);
    }
}
